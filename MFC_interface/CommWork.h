//////////////////////////////////////////////////////////////////////////////////////////////////////////
// File		: CommWork.h
// Version	: 1.0.1
// Date		: 2022.08.31
// Writer	: Kim, YeLin (MRAS)
//////////////////////////////////////////////////////////////////////////////////////////////////////////

#pragma once

#ifndef _COMMWORK_H__
#define _COMMWORK_H__

#include "Comm.h"
#include "WorkBase.h"
#include "DataType.h"
#include "SystemMemory.h"
#include <iostream>
#include <chrono>


//////////////////////////////////////////////////////////////////////////////////////////////////////////
// Class Name	: CCommWork  : public CWorkBase
// Summury		: Communication work class
//////////////////////////////////////////////////////////////////////////////////////////////////////////
class CCommWork : public CWorkBase {

	// Define ////////////////////////////////////////////////////////
public:

protected:

private:


	// Method ////////////////////////////////////////////////////////
public:
	CCommWork(std::string name);
	virtual ~CCommWork();

	bool OpenPort(std::string name, int baudRate);
	void ClosePort();

protected:
	////////////////////////////////////////////////////////////////////////////////////////////
	// Method	: _execute(virtual)
	// Input	: None
	// Output	: None
	////////////////////////////////////////////////////////////////////////////////////////////
	virtual void _execute();

private:


	// Member ////////////////////////////////////////////////////////
public:

protected:

private:
	std::string _memname_omega;
	std::string _memname_stm;
	OmegaData_t _omega;
	StmData_t _stm;

	CComm _comm;
	unsigned char _recvBuf[4096];
	unsigned char _sendBuf[4096];

	SendPacket_t _sendPacket;
	RecvPacket_t _recvPacket;
};

#endif